{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "description": "Percentage of male and female players in different ranks",
    "width": 500,
    "height": 300,
    "data":{
        "url": "https://raw.githubusercontent.com/Neeva-shinie/Neeva-shinie.github.io/master/test.csv"
    },
    "layer": [{
        "mark":{"type":"arc", "innerRadius": 50},
        "transform": [{
            "window": [{
                "op":"sum",
                "field": "GMs",
                "as":"TotalGM"

                
            },
            {
                "op": "sum",
                "field": "WGMs",
                "as": "TotalWGM"


            }]

        },

        {
            "aggregate": [{ "op": "count", "as": "count_gm" }],
            "groupby": ["GMs"]
          },

        {
            "aggregate": [{ "op": "count", "as": "count_wgm" }],
            "groupby": ["WGMs"]
          },


          {
            "calculate": "(datum.count_gm / (datum.TotalGM + datum.TotalWGM)) * 100",
            "as": "percent_gm"
          },

          {
            "calculate": "(datum.count_wgm / (datum.TotalGM + datum.TotalWGM)) * 100",
            "as": "percent_wgm"
          }
    
    ],
        "encoding": {
            "theta":{"field":"percent_gm", "type": "quantitative"}

        
        }

        



    }]













}